<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>3D Savaş Alanı - Hareket Testi</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; }
        #ui { position: absolute; top: 10px; left: 10px; color: white; font-family: sans-serif; pointer-events: none; text-shadow: 2px 2px 4px #000; }
    </style>
</head>
<body>
    <div id="ui">
        <h1>Karakter Kontrolü Aktif</h1>
        <p>W, A, S, D ile hareket et | Boşluk (Space) ile zıpla!</p>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';

        // --- SAHNE VE KAMERA KURULUMU ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87ceeb); // Gökyüzü
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // --- IŞIKLANDIRMA ---
        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(5, 10, 7.5);
        scene.add(light);
        scene.add(new THREE.AmbientLight(0x404040));

        // --- ZEMİN (PUBG HARİTASI BAŞLANGICI) ---
        const grid = new THREE.GridHelper(100, 100); // Yolu şaşırmamak için çizgiler ekleyelim
        scene.add(grid);
        const floorGeo = new THREE.PlaneGeometry(100, 100);
        const floorMat = new THREE.MeshStandardMaterial({ color: 0x338833 });
        const floor = new THREE.Mesh(floorGeo, floorMat);
        floor.rotation.x = -Math.PI / 2;
        scene.add(floor);

        // --- KARAKTER (BİZİM OYUNCU) ---
        const playerGeo = new THREE.BoxGeometry(1, 2, 1); // 2 metre boyunda bir karakter
        const playerMat = new THREE.MeshStandardMaterial({ color: 0xff0000 });
        const player = new THREE.Mesh(playerGeo, playerMat);
        player.position.y = 1; // Ayakları yere değsin
        scene.add(player);

        // --- HAREKET DEĞİŞKENLERİ ---
        const keys = {};
        const speed = 0.1;
        let velocityY = 0; // Zıplama hızı
        const gravity = 0.01;

        // Tuşlara basılma durumunu takip et
        window.addEventListener('keydown', (e) => keys[e.code] = true);
        window.addEventListener('keyup', (e) => keys[e.code] = false);

        function updateMovement() {
            // W-S (İleri-Geri)
            if (keys['KeyW']) player.position.z -= speed;
            if (keys['KeyS']) player.position.z += speed;
            
            // A-D (Sağ-Sol)
            if (keys['KeyA']) player.position.x -= speed;
            if (keys['KeyD']) player.position.x += speed;

            // Boşluk (Zıplama) - Sadece yerdeyse zıplasın
            if (keys['Space'] && player.position.y <= 1) {
                velocityY = 0.2;
            }

            // Yerçekimi simülasyonu
            player.position.y += velocityY;
            if (player.position.y > 1) {
                velocityY -= gravity;
            } else {
                player.position.y = 1;
                velocityY = 0;
            }

            // KAMERA TAKİBİ (Kamerayı karakterin arkasına sabitleyelim)
            camera.position.set(player.position.x, player.position.y + 3, player.position.z + 7);
            camera.lookAt(player.position);
        }

        // --- ANİMASYON DÖNGÜSÜ ---
        function animate() {
            requestAnimationFrame(animate);
            updateMovement();
            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
